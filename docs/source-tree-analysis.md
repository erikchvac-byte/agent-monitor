# Source Tree Analysis

## Project Structure

```
C:\Users\erikc\Dev\Lincoln/
â”‚
â”œâ”€â”€ ğŸ“ src/                           # Source code directory
â”‚   â”œâ”€â”€ ğŸ“„ App.tsx                   # Main React component (UI, state, keyboard input) [168 LOC]
â”‚   â”œâ”€â”€ ğŸ“„ index.ts                  # CLI entry point (bootstrap, TTY check) [18 LOC]
â”‚   â”œâ”€â”€ ğŸ“„ logTailer.ts             # File watching & JSONL parsing service [170 LOC]
â”‚   â”œâ”€â”€ ğŸ“„ notes.ts                  # Note persistence & auto-tagging service [61 LOC]
â”‚   â””â”€â”€ ğŸ“„ types.ts                 # Shared types & agent classification [54 LOC]
â”‚
â”œâ”€â”€ ğŸ“ dist/                         # Compiled TypeScript output (generated)
â”‚   â”œâ”€â”€ ğŸ“„ index.js                  # CLI binary entry point
â”‚   â”œâ”€â”€ ğŸ“„ App.js                   # Compiled React component
â”‚   â”œâ”€â”€ ğŸ“„ logTailer.js             # Compiled LogTailer service
â”‚   â”œâ”€â”€ ğŸ“„ notes.js                 # Compiled NoteWriter service
â”‚   â”œâ”€â”€ ğŸ“„ types.js                # Compiled type definitions
â”‚   â””â”€â”€ *.d.ts.map                  # TypeScript source maps (debugging)
â”‚
â”œâ”€â”€ ğŸ“ node_modules/                # npm dependencies (git-ignored)
â”‚
â”œâ”€â”€ ğŸ“ _bmad/                       # BMad framework & workflows (git-ignored)
â”‚   â”œâ”€â”€ ğŸ“ bmm/                     # Business Module Management workflows
â”‚   â”œâ”€â”€ ğŸ“ bmb/                     # Business Module Builder workflows
â”‚   â””â”€â”€ ğŸ“ cis/                     # Creative Intelligence System workflows
â”‚
â”œâ”€â”€ ğŸ“ _bmad-output/                # BMad workflow artifacts (git-ignored)
â”‚   â”œâ”€â”€ ğŸ“ planning-artifacts/        # Planning documents (PRD, architecture, epics)
â”‚   â”œâ”€â”€ ğŸ“ implementation-artifacts/  # Implementation documents (sprint plans, stories)
â”‚   â””â”€â”€ ğŸ“„ bmm-workflow-status.yaml  # Workflow progress tracker
â”‚
â”œâ”€â”€ ğŸ“ .opencode/                   # OpenCode configuration (git-ignored)
â”‚   â”œâ”€â”€ ğŸ“ agents/                  # Agent definitions
â”‚   â””â”€â”€ ğŸ“ commands/                # Command definitions
â”‚
â”œâ”€â”€ ğŸ“ docs/                        # Generated documentation (this scan output)
â”‚   â”œâ”€â”€ ğŸ“„ project-structure.md
â”‚   â”œâ”€â”€ ğŸ“„ existing-documentation-inventory.md
â”‚   â”œâ”€â”€ ğŸ“„ technology-stack.md
â”‚   â”œâ”€â”€ ğŸ“„ cli-project-analysis.md
â”‚   â”œâ”€â”€ ğŸ“„ source-tree-analysis.md
â”‚   â””â”€â”€ ğŸ“„ project-scan-report.json
â”‚
â”œâ”€â”€ ğŸ“„ package.json                  # Project metadata, dependencies, scripts
â”œâ”€â”€ ğŸ“„ tsconfig.json                # TypeScript compilation options
â”œâ”€â”€ ğŸ“„ .gitignore                  # Git exclusions (node_modules, dist, logs)
â”œâ”€â”€ ğŸ“„ .claude/                    # Claude Code configuration
â”œâ”€â”€ ğŸ“„ README.md                   # Project overview & usage guide
â”œâ”€â”€ ğŸ“„ CLAUDE.md                   # Development guide for Claude Code
â”œâ”€â”€ ğŸ“„ TESTING.md                  # Testing procedures
â””â”€â”€ ğŸ“„ package-lock.json           # npm dependency lockfile (git-ignored)
```

## Critical Directory Breakdown

### `/src/` - Source Code

**Purpose:** All TypeScript source files (flat structure)

**Key Characteristics:**
- **Organization:** Coarse-grained (one concern per file)
- **Exports:** ES Modules (.js extension for TypeScript)
- **Build Target:** ES2020, ESNext modules
- **Total Size:** 5 files, 463 lines of code

**Entry Points:**
- `index.ts` â†’ CLI binary entry (shebang: `#!/usr/bin/env node`)
- `App.tsx` â†’ React UI component entry

**Module Dependencies:**
```
src/index.ts
  â””â”€â”€ src/App.tsx
      â”œâ”€â”€ src/logTailer.ts
      â”œâ”€â”€ src/notes.ts
      â””â”€â”€ src/types.ts (shared)
```

### `/dist/` - Compiled Output

**Purpose:** JavaScript output from TypeScript compilation

**Generated Files:**
- `*.js` - Compiled JavaScript files
- `*.d.ts` - TypeScript declaration files
- `*.d.ts.map` - Source maps for debugging

**Exclusions:**
- Git-ignored (not versioned)
- Generated by `npm run build`
- Source for `npm start` command

### `/node_modules/` - Dependencies

**Purpose:** npm packages (auto-installed)

**Key Dependencies:**
- `ink@6.6.0` - React terminal UI framework
- `react@19.2.3` - React library
- `chokidar@5.0.0` - File watching
- `chalk@5.6.2` - Terminal colors

**Exclusions:**
- Git-ignored (not versioned)
- 225+ dependencies in tree

### `/_bmad/` - BMad Framework

**Purpose:** BMad project management framework (external)

**Subdirectories:**
- `bmm/` - Business workflows (analysis, planning, solutioning, implementation)
- `bmb/` - Module builder workflows (agents, modules, workflows)
- `cis/` - Creative intelligence system workflows (storytelling, problem-solving)

**Exclusions:**
- Git-ignored (framework directory)
- Not part of project codebase

### `/_bmad-output/` - BMad Artifacts

**Purpose:** Workflow-generated planning and implementation documents

**Subdirectories:**
- `planning-artifacts/` - PRDs, architecture, epics
- `implementation-artifacts/` - Sprint plans, user stories

**Key File:**
- `bmm-workflow-status.yaml` - Workflow progress tracker

**Exclusions:**
- Git-ignored (artifacts directory)
- Generated by BMad workflows

### `/.opencode/` - OpenCode Config

**Purpose:** OpenCode agent and command definitions

**Subdirectories:**
- `agents/` - Agent configuration files
- `commands/` - Command definitions for BMad system

**Exclusions:**
- Git-ignored (OpenCode internal)
- Not part of project codebase

### `/docs/` - Documentation

**Purpose:** Generated project documentation (this scan output)

**Files Generated:**
- `project-structure.md` - Project classification and parts
- `existing-documentation-inventory.md` - Existing docs catalog
- `technology-stack.md` - Tech stack and architecture patterns
- `cli-project-analysis.md` - Deep CLI project analysis
- `source-tree-analysis.md` - This document
- `project-scan-report.json` - Workflow state file

**Exclusions:**
- Git-ignored (generated documentation)
- Updated by document-project workflow

## File System Patterns

### Build Artifacts (Excluded)

| Pattern | Location | Reason |
|----------|-----------|---------|
| `dist/` | Root | TypeScript compilation output |
| `build/` | Root | Alternate build output |
| `*.tsbuildinfo` | Root | TypeScript build cache |
| `coverage/` | Root | Jest test coverage |
| `.nyc_output/` | Root | NYC coverage data |

### Environment Files (Excluded)

| Pattern | Location | Reason |
|----------|-----------|---------|
| `.env` | Root | Environment variables |
| `.env.local` | Root | Local overrides |
| `.env.*.local` | Root | Environment-specific overrides |

### Logs (Excluded)

| Pattern | Location | Reason |
|----------|-----------|---------|
| `*.log` | Root | Log files (runtime) |
| `logs/` | Root | Log directory |
| `progress-notes.txt` | Root | User-generated notes (runtime) |

### IDE & OS Files (Excluded)

| Pattern | Location | Reason |
|----------|-----------|---------|
| `.vscode/` | Root | VS Code workspace |
| `.idea/` | Root | JetBrains IDE |
| `*.swp`, `*.swo` | Root | Vim swap files |
| `.DS_Store` | Root | macOS metadata |
| `Thumbs.db` | Root | Windows thumbnail cache |

## Integration Points

### External Dependencies

| External System | Interface | Purpose |
|----------------|-----------|---------|
| **Agents Logs** | `../Agents/logs/conversation_logs/*.log` | Source of agent activity data (JSONL format) |
| **Node.js Runtime** | CLI execution | Runtime environment |
| **Terminal** | stdin/stdout | User input and output |

### Internal Module Flow

```
External Log Files (JSONL)
        â†“ (chokidar file watcher)
    LogTailer.readNewLines()
        â†“ (JSON.parse â†’ Activity)
    LogTailer.parseLine()
        â†“ (callback)
    React.setState(activities)
        â†“ (React re-render)
    ink Terminal UI Display
```

## Deployment Considerations

### Distribution

| Step | Command | Output |
|-------|---------|--------|
| **Build** | `npm run build` | `dist/` directory |
| **Package** | `npm pack` | `.tgz` tarball |
| **Publish** | `npm publish` | npm registry |

### Binary Execution

- **Shebang:** `#!/usr/bin/env node` (Unix executable)
- **Windows:** Requires Node.js in PATH
- **Permissions:** `chmod +x dist/index.js` (Unix)

### Configuration

- **Log Directory:** Hardcoded in `LogTailer` constructor (`../Agents/logs/conversation_logs`)
- **Notes File:** Hardcoded in `NoteWriter` constructor (`progress-notes.txt`)
- **Buffer Size:** Hardcoded in `LogTailer` constructor (50 activities)

**Future Enhancement:** Consider adding config file support for customization.

## Critical Files Summary

| File | Criticality | Reason |
|------|--------------|--------|
| `src/index.ts` | â­â­â­ | CLI entry point, shebang for executable |
| `src/App.tsx` | â­â­â­ | Main UI component, application logic |
| `src/logTailer.ts` | â­â­ | Core service, file watching & parsing |
| `src/types.ts` | â­â­ | Shared types, used by all modules |
| `src/notes.ts` | â­ | Note persistence service |
| `package.json` | â­â­â­ | Dependencies, scripts, metadata |
| `tsconfig.json` | â­â­ | TypeScript compilation config |
| `.gitignore` | â­ | Prevents committing unwanted files |

## Next Steps for Source Navigation

1. **For Understanding Architecture:** Start with `src/types.ts` â†’ `src/logTailer.ts` â†’ `src/App.tsx`
2. **For Modifying UI:** Edit `src/App.tsx` (keyboard handlers, rendering)
3. **For Changing Log Parsing:** Edit `src/logTailer.ts` (JSONL parsing, buffer logic)
4. **For Updating Types:** Edit `src/types.ts` (Activity, LogEntry interfaces)
5. **For Changing Output:** Edit `src/notes.ts` (note format, auto-tagging)
